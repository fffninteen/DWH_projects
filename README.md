# Практическая работа по курсу "Хранилища данных"

На курсе по проектированию и разработке хранилищ данных (DWH) я изучал полный жизненный цикл данных - от извлечения из источников до формирования витрин. В рамках обучения я освоил ключевые концепции: многослойную архитектуру (Raw Data, 3NF Core, Data Marts), методологии загрузки (ETL/ELT), типы таблиц (факты, измерения) и стратегии обработки изменений (SCD Type 1-4). Практическая часть была сфокусирована на реализации этих концепций в реальных сценариях. Курс вёл приглашенный спикер из Газпромбанка (Федотов Александр).

Вот примеры практических задач, которые я выполнял:

## 1. Разработка универсального загрузчика для слоя сырых данных (Raw Data Layer)
**Задача:** Создать гибкий инструмент для приема разноформатных данных из источников.
**Что я делал:** Разработал Python-скрипт (`raw_data_loader.py`), который автоматически определяет формат файла (CSV/JSON) и загружает его содержимое в соответствующую таблицу в схеме `raw_data`. Для обеспечения идемпотентности скрипт перед загрузкой очищает целевую таблицу командой `TRUNCATE`, не затрагивая ее структуру. Это позволило надежно и автоматизированно наполнять "озеро" сырых данных из 7 различных файлов.

## 2. Реализация хранения истории изменений в нормализованном слое (3NF Core Layer)
**Задача:** Внедрить механизм аудита изменений для критичных справочников.
**Что я делал:** Для таблицы `core.legal` реализовал методологию Slowly Changing Dimension Type 4 (SCD4). Я создал отдельную таблицу `core.legal_history` и доработал процедуру загрузки `core.p_legal_load`. Теперь при каждой вставке или обновлении записи в основной таблице, ее "снимок" сохраняется в исторической, что позволяет отслеживать, кто, когда и как менял данные.

## 3. Усовершенствование фреймворка загрузки витрин данных (Data Mart Layer)
**Задача:** Добавить в таблицы аналитического слоя метрику для отслеживания "активности" записей.
**Что я делал:** Добавил во все таблицы слоя `dm` техническое поле `_upsert_count`. Затем модифицировал универсальный фреймворк загрузки `dm.p_dm_table_loader`, научив его увеличивать значение этого счетчика на 1 при любом действии с записью (вставка, обновление, soft-delete). Это дает аналитикам простой индикатор того, насколько часто менялась та или иная запись в витрине.

## 4. Создание сквозного пайплайна загрузки данных
**Задача:** Автоматизировать полный цикл движения данных от источника до витрины.
**Что я делал:** Разработал главный управляющий Python-скрипт (`dwh_table_loader.py`), который координирует весь процесс ELT. Скрипт последовательно запускает загрузку данных из файлов в слой `raw_data`, затем их трансформацию и перенос в нормализованный слой `core`, и наконец - агрегацию в аналитические витрины `dm`, строго соблюдая порядок зависимостей между таблицами.
